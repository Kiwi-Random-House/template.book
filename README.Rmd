---
output: github_document
---

```{r setup, echo = FALSE, results = 'hide', message = FALSE, warning = FALSE, include= FALSE}
knitr::opts_chunk$set(results = FALSE, echo = FALSE, message = FALSE)
try(remotes::install_cran(c("desc", "stringr", "yaml")))
desc_obj <- desc::description$new()
```

```{r helpers}
generate_shield_src <- function(label = "codecov", message = "0%", color = "red"){
    replace_symbols <- function(x){
        x <- gsub("%", "%25", x)
        x <- gsub(" ", "%20", x)
        x <- gsub("-", "--", x)
        x <- gsub("_", "__", x)
        return(x)
    }

    paste0("https://img.shields.io/badge/", replace_symbols(label), "-", replace_symbols(message), "-", color, ".svg")
}
```

```{r badges}
badges <- list()

badges$published <- list(
  badge_name = "Published Version", 
  href = desc_obj$get_urls()[1], 
  src = generate_shield_src("Book Version", "Published", "0087BD")
)

badges$preview <- list(
  badge_name = "Preview Version", 
  href = desc_obj$get_urls()[2], 
  src = generate_shield_src("Book Version", "Preview", "ff69b4")
)

invisible(lapply(badges, do.call, what = usethis::use_badge))
```

# `r desc_obj$get_field("Title")`

<!-- badges: start -->
[![Published Version](https://img.shields.io/badge/Book%20Version-Published-0087BD.svg)](https://template-book.netlify.com/)
[![Preview Version](https://img.shields.io/badge/Book%20Version-Preview-ff69b4.svg)](https://gh-preview--template-book.netlify.app/)
<!-- badges: end -->

---

`r desc_obj$get_field("Description")`
